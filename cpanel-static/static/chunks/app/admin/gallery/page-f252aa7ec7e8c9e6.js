(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3831],{3805:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>o});var a=r(5155),s=r(2115),l=r(5695),i=r(2292);function o(){var e,t,r;let[o,n]=(0,s.useState)([]),[c,d]=(0,s.useState)(!0),[m,u]=(0,s.useState)(null),[g,x]=(0,s.useState)(!1),[p,h]=(0,s.useState)(null),f=(0,l.useRouter)(),[y,b]=(0,s.useState)({title:"",description:"",category:"",images:[],featured:!1,tags:[],date:new Date().toISOString().split("T")[0]}),[j,v]=(0,s.useState)(!1);(0,s.useEffect)(()=>{N()},[]);let N=async()=>{try{let e=await fetch("/api/collages");if(e.ok){let t=await e.json();n(t)}}catch(e){console.error("Failed to fetch collages:",e)}finally{d(!1)}},w=e=>{let{name:t,value:r,type:a}=e.target;b(s=>({...s,[t]:"checkbox"===a?e.target.checked:r}))},O=async e=>{var t;if(!(null==(t=e.target.files)?void 0:t.length))return;x(!0);let r=Array.from(e.target.files),a=[];try{for(let e of r){let t=new FormData;t.append("file",e);let r=await fetch("/api/upload",{method:"POST",body:t});if(r.ok){let{url:e}=await r.json();a.push(e)}else throw Error("Upload failed")}b(e=>({...e,images:[...e.images||[],...a]}))}catch(e){console.error("Upload failed:",e),alert("Failed to upload images. Please try again.")}finally{x(!1)}},k=async e=>{e.preventDefault();try{let e=m?"/api/collages/".concat(m.id):"/api/collages",t=m?"PUT":"POST";if((await fetch(e,{method:t,headers:{"Content-Type":"application/json"},body:JSON.stringify(y)})).ok)P(),N();else throw Error("Failed to save collage")}catch(e){console.error("Error saving collage:",e),alert("Failed to save collage. Please try again.")}},C=async e=>{if(confirm("Are you sure you want to delete this collage?"))try{if((await fetch("/api/collages/".concat(e),{method:"DELETE"})).ok)N();else throw Error("Failed to delete collage")}catch(e){console.error("Error deleting collage:",e),alert("Failed to delete collage. Please try again.")}},P=()=>{b({title:"",description:"",category:"",images:[],featured:!1,tags:[],date:new Date().toISOString().split("T")[0]}),u(null),h(null)},E=async e=>{if(!m)return;v(!0);let t=[...y.images||[]];t.splice(e,1);let r={...y,images:t};b(r);try{if(!(await fetch("/api/collages/".concat(m.id),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)})).ok)throw Error("Failed to update collage");alert("Image deleted and collage updated successfully.")}catch(e){alert("Failed to update collage after deleting image.")}finally{v(!1)}};return c?(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,a.jsx)("div",{className:"text-xl",children:"Loading..."})}):(0,a.jsx)("div",{className:"min-h-screen bg-gray-50",children:(0,a.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-8",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-800",children:"Gallery Management"}),(0,a.jsx)("button",{onClick:()=>f.push("/"),className:"px-4 py-2 bg-gray-200 text-gray-700 rounded hover:bg-gray-300 transition",children:"Back to Site"})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6 mb-8",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold mb-4",children:m?"Edit Collage":"Add New Collage"}),(0,a.jsxs)("form",{onSubmit:k,className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Title *"}),(0,a.jsx)("input",{type:"text",name:"title",value:y.title||"",onChange:w,className:"w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category *"}),(0,a.jsx)("input",{type:"text",name:"category",value:y.category||"",onChange:w,className:"w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),(0,a.jsxs)("div",{className:"md:col-span-2",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),(0,a.jsx)("textarea",{name:"description",value:y.description||"",onChange:w,rows:3,className:"w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("input",{type:"checkbox",id:"featured",name:"featured",checked:y.featured||!1,onChange:w,className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),(0,a.jsx)("label",{htmlFor:"featured",className:"ml-2 block text-sm text-gray-700",children:"Featured Collage"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date"}),(0,a.jsx)("input",{type:"date",name:"date",value:y.date||"",onChange:w,className:"w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),(0,a.jsxs)("div",{className:"mt-4",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Images *"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-4 mb-4",children:[null==(e=y.images)?void 0:e.map((e,t)=>(0,a.jsxs)("div",{className:"relative group",children:[(0,a.jsx)("img",{src:e,alt:"Preview ".concat(t+1),className:"w-full h-24 object-cover rounded border border-gray-200",onMouseEnter:()=>h(e)}),(0,a.jsx)("button",{type:"button",onClick:()=>E(t),className:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full p-1 transition-opacity",disabled:j,children:(0,a.jsx)(i.QCr,{size:12})})]},t)),(0,a.jsx)("label",{className:"flex flex-col items-center justify-center h-24 border-2 border-dashed border-gray-300 rounded-lg cursor-pointer hover:border-blue-500 transition-colors",children:g?(0,a.jsx)("span",{className:"text-gray-500",children:"Uploading..."}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(i.HVe,{className:"text-gray-400 mb-1"}),(0,a.jsx)("span",{className:"text-sm text-gray-500",children:"Add Images"}),(0,a.jsx)("input",{type:"file",multiple:!0,accept:"image/*",onChange:O,className:"hidden"})]})})]}),p&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4",onClick:()=>h(null),children:(0,a.jsx)("div",{className:"max-w-4xl max-h-[90vh] overflow-auto",children:(0,a.jsx)("img",{src:p,alt:"Preview",className:"max-w-full max-h-[80vh] object-contain",onClick:e=>e.stopPropagation()})})})]}),(0,a.jsxs)("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-200",children:[(0,a.jsx)("button",{type:"button",onClick:P,className:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50",children:"Cancel"}),(0,a.jsx)("button",{type:"submit",disabled:g||!(null==(t=y.images)?void 0:t.length),className:"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white ".concat(!g&&(null==(r=y.images)?void 0:r.length)?"bg-blue-600 hover:bg-blue-700":"bg-blue-300 cursor-not-allowed"),children:m?"Update Collage":"Add Collage"})]})]})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:[(0,a.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,a.jsx)("h2",{className:"text-lg font-medium text-gray-900",children:"All Collages"})}),(0,a.jsx)("div",{className:"divide-y divide-gray-200",children:0===o.length?(0,a.jsx)("div",{className:"px-6 py-4 text-center text-gray-500",children:"No collages found. Create your first collage above."}):(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,a.jsx)("thead",{className:"bg-gray-50",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Preview"}),(0,a.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Title"}),(0,a.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Category"}),(0,a.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Images"}),(0,a.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Featured"}),(0,a.jsx)("th",{scope:"col",className:"relative px-6 py-3",children:(0,a.jsx)("span",{className:"sr-only",children:"Actions"})})]})}),(0,a.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:o.map(e=>{var t,r;return(0,a.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(null==(t=e.images)?void 0:t[0])?(0,a.jsx)("div",{className:"h-10 w-10 rounded-full overflow-hidden",children:(0,a.jsx)("img",{src:e.images[0],alt:e.title,className:"h-full w-full object-cover"})}):(0,a.jsx)("div",{className:"h-10 w-10 rounded-full bg-gray-200 flex items-center justify-center",children:(0,a.jsx)(FaImage,{className:"text-gray-400"})})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.title})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsx)("div",{className:"text-sm text-gray-500",children:e.category})}),(0,a.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:[(null==(r=e.images)?void 0:r.length)||0," images"]}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsx)("span",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full ".concat(e.featured?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"),children:e.featured?"Yes":"No"})}),(0,a.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[(0,a.jsxs)("button",{onClick:()=>{u(e),b({id:e.id,title:e.title,description:e.description||"",category:e.category,images:e.images,featured:e.featured||!1,tags:e.tags||[],date:e.date||new Date().toISOString().split("T")[0]}),window.scrollTo({top:0,behavior:"smooth"})},className:"text-blue-600 hover:text-blue-900 mr-4",children:[(0,a.jsx)(i.uO9,{className:"inline mr-1"})," Edit"]}),(0,a.jsxs)("button",{onClick:()=>e.id&&C(e.id),className:"text-red-600 hover:text-red-900",children:[(0,a.jsx)(i.qbC,{className:"inline mr-1"})," Delete"]})]})]},e.id)})})]})})})]})]})})}},4436:(e,t,r)=>{"use strict";r.d(t,{k5:()=>d});var a=r(2115),s={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},l=a.createContext&&a.createContext(s),i=["attr","size","title"];function o(){return(o=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function n(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,a)}return r}function c(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n(Object(r),!0).forEach(function(t){var a,s,l;a=e,s=t,l=r[t],(s=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(s))in a?Object.defineProperty(a,s,{value:l,enumerable:!0,configurable:!0,writable:!0}):a[s]=l}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function d(e){return t=>a.createElement(m,o({attr:c({},e.attr)},t),function e(t){return t&&t.map((t,r)=>a.createElement(t.tag,c({key:r},t.attr),e(t.child)))}(e.child))}function m(e){var t=t=>{var r,{attr:s,size:l,title:n}=e,d=function(e,t){if(null==e)return{};var r,a,s=function(e,t){if(null==e)return{};var r={};for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){if(t.indexOf(a)>=0)continue;r[a]=e[a]}return r}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)r=l[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}(e,i),m=l||t.size||"1em";return t.className&&(r=t.className),e.className&&(r=(r?r+" ":"")+e.className),a.createElement("svg",o({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,s,d,{className:r,style:c(c({color:e.color||t.color},t.style),e.style),height:m,width:m,xmlns:"http://www.w3.org/2000/svg"}),n&&a.createElement("title",null,n),e.children)};return void 0!==l?a.createElement(l.Consumer,null,e=>t(e)):t(s)}},5695:(e,t,r)=>{"use strict";var a=r(8999);r.o(a,"usePathname")&&r.d(t,{usePathname:function(){return a.usePathname}}),r.o(a,"useRouter")&&r.d(t,{useRouter:function(){return a.useRouter}})},6258:(e,t,r)=>{Promise.resolve().then(r.bind(r,3805))}},e=>{e.O(0,[6711,8441,5964,7358],()=>e(e.s=6258)),_N_E=e.O()}]);